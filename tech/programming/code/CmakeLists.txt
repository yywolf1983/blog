cmake_minimum_required(VERSION 3.10)
project(hash_check_project C)

# 设置 C 标准
set(CMAKE_C_STANDARD 99)
set(CMAKE_C_STANDARD_REQUIRED ON)

# 查找 OpenSSL 库
find_package(OpenSSL REQUIRED)

# 添加可执行文件
add_executable(hash_check hash_check.c)

# 链接 OpenSSL 的加密库
target_link_libraries(hash_check PRIVATE OpenSSL::Crypto)

# -------------------------------
# 启用测试支持
# -------------------------------

# 启用 CTest（CMake 自带的测试工具）
enable_testing()

# 定义一个自定义测试
# 它会运行程序并传递 --test 参数
add_test(
    NAME hash_check_test
    COMMAND hash_check --test
)

# 可选：设置工作目录（如果在 build 中运行，通常不需要）
# set_property(TEST hash_check_test PROPERTY WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})
