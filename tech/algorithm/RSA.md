# RSA 算法详解

RSA算法是一种非对称密码算法，所谓非对称，就是指该算法需要一对密钥，使用其中一个加密，则需要用另一个才能解密。

## 详解

### 1、随机选择两个不相等的质数p和q。

p = 3, q = 7

### 2、计算p和q的乘积n。n的二进制表示时所占用的位数，就是所谓的密钥长度。

n = 3*7 = 21

### 3、计算n的欧拉函数φ(n)。

φ(n) = (p-1)(q-1)
φ(n) =（3-1）*（7-1）= 12

### 4、随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质。

（实际应用中，常常选择65537。）
e = 11

### 5、计算e对于φ(n)的模反元素d。

ed mod φ(n) = 1
11*d  mod 12 = 1

扩展欧几里得算法 算出 模反元素是多个
d = 23

### 6、将n和e封装成公钥，n和d封装成私钥。

实际应用中，公钥和私钥的数据都采用ASN.1格式表达。

(n，e)为公钥
(n，d)为私钥。

### 幂模计算（单向限门）

 RSA加解密的算法完全相同，设A为明文(A<n)，B为密文，
 测试中A要小于N-2 当A=N-1 时，A=B
 则：
 加密 
    A^e mod n = B；
 解密
    B^d mod n = A
（公钥加密体制中，一般用公钥加密，私钥解密） e和d可以互换使用，即： A≡B^e (mod n)；B≡A^d( mod n);

## 模拟演算

n = 21
e = 11 
d = 23

A = 9
A^e mod n = B
9^11 % 21 =B
B = 18

B^d mod n = B
18^23 % 21 = 9


## RSA 公式

两个质素 p和q, p!=q
计算N=pq
计算 N 的欧拉函数(在所有比N小的自然数中，与N互质的数有多少各)
φ(N)=φ(p)φ(q)=(p-1)(q-1) = r

找一个数e 与r互质
     e*d%r=1 （ 重点在求d ）
     e*d = x*r+1
删除pq  (N,e)公钥   (N,d)私钥

加密M 如果 M大于N 等分M   M=m*x

加密
m^e%N = c

解密
c^d%N = m 原值

## 算法证明 （神奇的幂模运算）

 设明文为 X，密文为 Y，解密得到的明文为 Z，加密过程为：
  Y = X^e % N （X < N）
 解密过程为：
  Z = Y^d % N
 如果能证明在 e * d % φ(N)= 1 的前提下，Z ＝ X，就说明加解密的过程正确。

安全
   de=1 (mod(p-1)(q-1))并解出d，
   c^d    n(mod N)

## 签名

签名就是吧hash 结果做幂模运算
S = (H(T))^d  mod n
H(T) = S^e mod n